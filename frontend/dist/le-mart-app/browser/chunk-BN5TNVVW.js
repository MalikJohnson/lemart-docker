import{a as k}from"./chunk-YHL4MHUU.js";import{i as E,o as j}from"./chunk-CMEXFVJG.js";import{A as T,D as q,E as A,K as D,M as G,k as y,m as L,q as I,v as M,w as h,x as N,y as x}from"./chunk-66TIHPRD.js";import{Db as F,Eb as C,Mb as o,O as _,Ob as w,Ra as n,Wb as b,Xa as g,ab as S,gb as c,nb as a,sb as r,tb as t,ub as f}from"./chunk-J2LCUAOM.js";var P=i=>({"is-invalid":i});function B(i,l){if(i&1&&(r(0,"div",20),o(1),t()),i&2){let s=C();n(),w(" ",s.errorMessage," ")}}function V(i,l){i&1&&(r(0,"div",21),o(1," Username is required "),t())}function U(i,l){i&1&&(r(0,"div",21),o(1," Password is required "),t())}function W(i,l){i&1&&(r(0,"div",21),o(1," Password must be at least 6 characters "),t())}function z(i,l){i&1&&f(0,"span",22)}var R=class i{constructor(l,s,e,m){this.fb=l;this.authService=s;this.cartService=e;this.router=m;this.loginForm=this.fb.group({username:["",[h.required]],password:["",[h.required,h.minLength(6)]]})}loginForm;errorMessage="";isLoading=!1;onSubmit(){if(this.loginForm.invalid){this.loginForm.markAllAsTouched();return}this.isLoading=!0,this.errorMessage="",this.authService.login({username:this.loginForm.value.username,password:this.loginForm.value.password}).pipe(_(()=>this.cartService.syncWithServer())).subscribe({next:()=>{this.isLoading=!1,this.router.navigate(["/"])},error:l=>{this.isLoading=!1,this.errorMessage=l.message,this.router.navigate(["/"])}})}static \u0275fac=function(s){return new(s||i)(g(D),g(j),g(k),g(E))};static \u0275cmp=S({type:i,selectors:[["app-login"]],decls:30,vars:13,consts:[[1,"container","mt-5"],[1,"row","justify-content-center"],[1,"col-md-6"],[1,"card","shadow"],[1,"card-header","bg-primary","text-white"],[1,"mb-0"],[1,"card-body"],[3,"ngSubmit","formGroup"],["class","alert alert-danger",4,"ngIf"],[1,"mb-3"],["for","username",1,"form-label"],["type","text","id","username","formControlName","username","placeholder","Enter your username",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","password",1,"form-label"],["type","password","id","password","formControlName","password","placeholder","Enter your password",1,"form-control",3,"ngClass"],[1,"d-grid","gap-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-2","role","status","aria-hidden","true",4,"ngIf"],[1,"mt-3","text-center"],["routerLink","/signup"],[1,"alert","alert-danger"],[1,"invalid-feedback"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"]],template:function(s,e){if(s&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),o(6,"Login to Le Mart"),t()(),r(7,"div",6)(8,"form",7),F("ngSubmit",function(){return e.onSubmit()}),c(9,B,2,1,"div",8),r(10,"div",9)(11,"label",10),o(12,"Username"),t(),f(13,"input",11),c(14,V,2,0,"div",12),t(),r(15,"div",9)(16,"label",13),o(17,"Password"),t(),f(18,"input",14),c(19,U,2,0,"div",12)(20,W,2,0,"div",12),t(),r(21,"div",15)(22,"button",16),c(23,z,1,0,"span",17),o(24," Login "),t()()(),r(25,"div",18)(26,"p"),o(27,"Don't have an account? "),r(28,"a",19),o(29,"Sign up"),t()()()()()()()()),s&2){let m,d,v,p,u;n(8),a("formGroup",e.loginForm),n(),a("ngIf",e.errorMessage),n(4),a("ngClass",b(9,P,((m=e.loginForm.get("username"))==null?null:m.invalid)&&((m=e.loginForm.get("username"))==null?null:m.touched))),n(),a("ngIf",((d=e.loginForm.get("username"))==null||d.errors==null?null:d.errors.required)&&((d=e.loginForm.get("username"))==null?null:d.touched)),n(4),a("ngClass",b(11,P,((v=e.loginForm.get("password"))==null?null:v.invalid)&&((v=e.loginForm.get("password"))==null?null:v.touched))),n(),a("ngIf",((p=e.loginForm.get("password"))==null||p.errors==null?null:p.errors.required)&&((p=e.loginForm.get("password"))==null?null:p.touched)),n(),a("ngIf",((u=e.loginForm.get("password"))==null||u.errors==null?null:u.errors.minlength)&&((u=e.loginForm.get("password"))==null?null:u.touched)),n(2),a("disabled",e.loginForm.invalid||e.isLoading),n(),a("ngIf",e.isLoading)}},dependencies:[I,y,L,G,T,M,N,x,q,A],encapsulation:2})};export{R as LoginComponent};
