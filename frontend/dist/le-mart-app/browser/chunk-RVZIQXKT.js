import{a as K}from"./chunk-IDLD7SZC.js";import{a as H}from"./chunk-YHL4MHUU.js";import{h as X}from"./chunk-PMZGBCKH.js";import{i as N,j as O,m as Q,o as G}from"./chunk-CMEXFVJG.js";import{B as U,I as z,J,L as Y,l as B,m as L,p as R,q as A,v as $,x as D,z as W}from"./chunk-66TIHPRD.js";import{Db as f,Eb as s,Hb as F,Mb as n,Nb as _,O as T,Ob as M,Pa as k,Ra as o,Rb as j,Sb as q,Tb as P,Xa as x,Yb as h,Zb as g,a as C,ab as V,b as S,ga as u,gb as b,ha as v,m as I,nb as d,q as w,sb as e,tb as i,ub as p,w as E,yb as y}from"./chunk-J2LCUAOM.js";function tt(l,r){l&1&&(e(0,"div",13),p(1,"i",14),e(2,"h3",15),n(3,"Your cart is empty"),i(),e(4,"p",16),n(5,"Looks like you haven't added any products to your cart yet"),i(),e(6,"button",17),n(7,"Continue Shopping"),i()())}function et(l,r){l&1&&(e(0,"div",13)(1,"div",18)(2,"span",19),n(3,"Loading..."),i()(),e(4,"p",20),n(5,"Loading your cart..."),i()())}function it(l,r){if(l&1){let t=y();e(0,"tr")(1,"td")(2,"div",27),p(3,"img",28),e(4,"div",29)(5,"h6",5),n(6),i()()()(),e(7,"td"),n(8),h(9,"currency"),i(),e(10,"td")(11,"div",27)(12,"button",30),f("click",function(){let c=u(t).$implicit,m=s(2);return v(m.updateQuantity(c,c.quantity-1))}),p(13,"i",31),i(),e(14,"input",32),P("ngModelChange",function(c){let m=u(t).$implicit;return q(m.quantity,c)||(m.quantity=c),v(c)}),f("change",function(){let c=u(t).$implicit,m=s(2);return v(m.updateQuantity(c,c.quantity))}),i(),e(15,"button",30),f("click",function(){let c=u(t).$implicit,m=s(2);return v(m.updateQuantity(c,c.quantity+1))}),p(16,"i",33),i()()(),e(17,"td",34),n(18),h(19,"currency"),i(),e(20,"td")(21,"button",35),f("click",function(){let c=u(t).$implicit,m=s(2);return v(m.removeFromCart(c))}),p(22,"i",36),i()()()}if(l&2){let t=r.$implicit;o(3),F("alt",t.product.name),d("src",t.product.imageUrl||"assets/img/placeholder.jpg",k),o(3),_(t.product.name),o(2),_(g(9,10,t.product.price)),o(4),d("disabled",t.quantity<=1),o(2),d("min",1)("max",t.product.stockQuantity),j("ngModel",t.quantity),o(),d("disabled",t.quantity>=t.product.stockQuantity),o(3),_(g(19,12,t.product.price*t.quantity))}}function nt(l,r){if(l&1&&(e(0,"div",21)(1,"table",22)(2,"thead")(3,"tr")(4,"th",23),n(5,"Product"),i(),e(6,"th",24),n(7,"Price"),i(),e(8,"th",25),n(9,"Quantity"),i(),e(10,"th",24),n(11,"Total"),i(),p(12,"th"),i()(),e(13,"tbody"),b(14,it,23,14,"tr",26),i()()()),l&2){let t=s();o(14),d("ngForOf",t.cartItems)}}function rt(l,r){if(l&1){let t=y();e(0,"div",37)(1,"button",38),p(2,"i",39),n(3,"Continue Shopping "),i(),e(4,"button",40),f("click",function(){u(t);let c=s();return v(c.clearCart())}),p(5,"i",41),n(6,"Clear Cart "),i()()}}function at(l,r){if(l&1){let t=y();e(0,"div")(1,"div",42)(2,"span"),n(3,"Subtotal"),i(),e(4,"span"),n(5),h(6,"currency"),i()(),e(7,"div",42)(8,"span"),n(9,"Shipping"),i(),e(10,"span"),n(11),h(12,"currency"),i()(),e(13,"div",42)(14,"span"),n(15),i(),e(16,"span"),n(17),h(18,"currency"),i()(),p(19,"hr"),e(20,"div",42)(21,"span",34),n(22,"Total"),i(),e(23,"span",43),n(24),h(25,"currency"),i()(),e(26,"button",44),f("click",function(){u(t);let c=s();return v(c.proceedToCheckout())}),n(27," Proceed to Checkout "),i()()}if(l&2){let t=s();o(5),_(g(6,6,t.calculateSubtotal())),o(6),_(g(12,8,t.calculateShipping())),o(4),M("Tax (",(t.taxRate*100).toFixed(2),"%)"),o(2),_(g(18,10,t.calculateTax())),o(7),_(g(25,12,t.calculateTotal())),o(2),d("disabled",t.cartItems.length===0)}}function ot(l,r){l&1&&(e(0,"div",45)(1,"p",16),n(2,"Add items to your cart to see the order summary"),i()())}function lt(l,r){l&1&&(e(0,"div",45)(1,"div",46)(2,"span",19),n(3,"Loading..."),i()()())}var Z=class l{constructor(r,t,a,c,m){this.cartService=r;this.productService=t;this.authService=a;this.router=c;this.toastr=m}cartItems=[];loading=!1;taxRate=.07;shippingFee=5.99;freeShippingThreshold=50;ngOnInit(){this.loadCartItems()}loadCartItems(){this.loading=!0,this.cartService.cart$.pipe(T(r=>r.length===0?I([]):E(r.map(t=>this.productService.getById(t.productId).pipe(w(a=>S(C({},t),{product:a}))))))).subscribe({next:r=>{this.cartItems=r,this.loading=!1},error:r=>{console.error("Error loading cart items",r),this.loading=!1,this.toastr.error("Failed to load cart items")}})}updateQuantity(r,t){t<1||(this.loading=!0,this.cartService.updateItem(r.productId,t),this.loading=!1)}removeFromCart(r){this.loading=!0,this.cartService.removeItem(r.productId),this.loading=!1,this.toastr.success("Item removed from cart")}clearCart(){confirm("Are you sure you want to clear your cart?")&&(this.loading=!0,this.cartService.clearCart(),this.loading=!1,this.toastr.success("Cart cleared"))}calculateSubtotal(){return this.cartItems.reduce((r,t)=>r+t.product.price*t.quantity,0)}calculateShipping(){return this.calculateSubtotal()>=this.freeShippingThreshold?0:this.shippingFee}calculateTax(){return parseFloat((this.calculateSubtotal()*this.taxRate).toFixed(2))}calculateTotal(){return this.calculateSubtotal()+this.calculateShipping()+this.calculateTax()}proceedToCheckout(){this.router.navigate(["/checkout"])}static \u0275fac=function(t){return new(t||l)(x(H),x(K),x(G),x(N),x(X))};static \u0275cmp=V({type:l,selectors:[["app-cart"]],decls:21,vars:7,consts:[[1,"container","py-5"],[1,"row"],[1,"col-lg-8"],[1,"card","mb-4"],[1,"card-header","bg-primary","text-white"],[1,"mb-0"],[1,"card-body"],["class","text-center py-5",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","d-flex justify-content-between mt-3",4,"ngIf"],[1,"col-lg-4"],[4,"ngIf"],["class","text-center py-3",4,"ngIf"],[1,"text-center","py-5"],[1,"bi","bi-cart-x","display-1","text-muted"],[1,"mt-3"],[1,"text-muted"],["routerLink","/",1,"btn","btn-primary"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2"],[1,"table-responsive"],[1,"table","table-hover"],[2,"width","50%"],[2,"width","15%"],[2,"width","20%"],[4,"ngFor","ngForOf"],[1,"d-flex","align-items-center"],[1,"img-fluid","rounded",2,"width","80px","height","80px","object-fit","cover",3,"src","alt"],[1,"ms-3"],[1,"btn","btn-sm","btn-outline-secondary",3,"click","disabled"],[1,"bi","bi-dash"],["type","number",1,"form-control","mx-2",2,"width","60px",3,"ngModelChange","change","min","max","ngModel"],[1,"bi","bi-plus"],[1,"fw-bold"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"bi","bi-trash"],[1,"d-flex","justify-content-between","mt-3"],["routerLink","/",1,"btn","btn-outline-primary"],[1,"bi","bi-arrow-left","me-2"],[1,"btn","btn-outline-danger",3,"click"],[1,"bi","bi-trash","me-2"],[1,"d-flex","justify-content-between","mb-3"],[1,"fw-bold","fs-5"],[1,"btn","btn-primary","w-100","mt-3",3,"click","disabled"],[1,"text-center","py-3"],["role","status",1,"spinner-border","spinner-border-sm","text-primary"]],template:function(t,a){t&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h5",5),n(6,"Shopping Cart"),i()(),e(7,"div",6),b(8,tt,8,0,"div",7)(9,et,6,0,"div",7)(10,nt,15,1,"div",8)(11,rt,7,0,"div",9),i()()(),e(12,"div",10)(13,"div",3)(14,"div",4)(15,"h5",5),n(16,"Order Summary"),i()(),e(17,"div",6),b(18,at,28,14,"div",11)(19,ot,3,0,"div",12)(20,lt,4,0,"div",12),i()()()()()),t&2&&(o(8),d("ngIf",a.cartItems.length===0&&!a.loading),o(),d("ngIf",a.loading),o(),d("ngIf",a.cartItems.length>0&&!a.loading),o(),d("ngIf",a.cartItems.length>0&&!a.loading),o(7),d("ngIf",a.cartItems.length>0&&!a.loading),o(),d("ngIf",a.cartItems.length===0&&!a.loading),o(),d("ngIf",a.loading))},dependencies:[A,B,L,R,Y,$,U,D,J,z,W,Q,O],encapsulation:2})};export{Z as CartComponent};
